middleware-demo/
â”‚
â”œâ”€â”€ server.js
â”œâ”€â”€ middlewares/
â”‚   â”œâ”€â”€ logger.js
â”‚   â””â”€â”€ auth.js
â””â”€â”€ routes/
    â””â”€â”€ userRoutes.js
ğŸ“„ server.js
js
Copy code
const express = require("express");
const bodyParser = require("body-parser");
const logger = require("./middlewares/logger");
const auth = require("./middlewares/auth");
const userRoutes = require("./routes/userRoutes");

const app = express();
app.use(bodyParser.json());

// âœ… Custom Logging Middleware (applied globally)
app.use(logger);

// âœ… Routes (Authentication middleware applied selectively)
app.use("/api/users", auth, userRoutes);

// âœ… Start Server
const PORT = 3000;
app.listen(PORT, () => console.log(`âœ… Server running on http://localhost:${PORT}`));
âš™ï¸ middlewares/logger.js
js
Copy code
// Logger Middleware: Logs method, URL, and time
const logger = (req, res, next) => {
  const time = new Date().toISOString();
  console.log(`[${time}] ${req.method} ${req.originalUrl}`);
  next(); // Move to next middleware or route
};

module.exports = logger;
ğŸ” middlewares/auth.js
js
Copy code
// Simple Bearer Token Authentication Middleware
const auth = (req, res, next) => {
  const authHeader = req.headers["authorization"];

  // Check if Bearer token exists
  if (!authHeader || !authHeader.startsWith("Bearer ")) {
    return res.status(401).json({ message: "Unauthorized: Missing or invalid token" });
  }

  const token = authHeader.split(" ")[1];

  // Example: Static token validation (replace with real JWT verification)
  const validToken = "mySecretBearerToken123";

  if (token !== validToken) {
    return res.status(403).json({ message: "Forbidden: Invalid token" });
  }

  // Token valid â†’ proceed
  next();
};

module.exports = auth;
ğŸ§© routes/userRoutes.js
js
Copy code
const express = require("express");
const router = express.Router();

// Example Protected Routes
router.get("/", (req, res) => {
  res.json({ message: "âœ… Access granted: All users fetched successfully!" });
});

router.post("/", (req, res) => {
  const { name, email } = req.body;
  res.json({ message: "âœ… New user created!", user: { name, email } });
});

module.exports = router;
ğŸ§¾ How to Run
Install dependencies

bash
Copy code
npm init -y
npm install express body-parser
Run the server

bash
Copy code
node server.js
Test using Postman

Request:
GET http://localhost:3000/api/users

Header:

makefile
Copy code
Authorization: Bearer mySecretBearerToken123
âœ… Response:

json
Copy code
{
  "message": "âœ… Access granted: All users fetched successfully!"
}
âŒ If no or invalid token:

json
Copy code
{
  "message": "Unauthorized: Missing or invalid token"
}
